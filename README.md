# Telegram Mood Tracker Bot

Telegram-бот для ежедневного отслеживания настроения и других психологических показателей. Бот предназначен для помощи людям в мониторинге своего психологического состояния с акцентом на приватность данных и удобство использования.

## Основной функционал

- **Ежедневный ввод показателей**: оценка по шкале 1-10 настроения, сна, ровности настроения, уровня мании, депрессии, тревоги, раздражительности, работоспособности и общительности
- **Комментарии к записям**: возможность добавлять текстовые заметки к каждой записи
- **Многократное обновление записей**: возможность вводить данные несколько раз в день, обновляя последнюю запись
- **Управление записями**: возможность удаления всех записей или записей за определенную дату
- **Статистика**: средние значения всех показателей за период
- **Аналитика паттернов**: выявление закономерностей, корреляций и предоставление персонализированных инсайтов
- **Визуализация данных**: графики динамики показателей, тепловые карты и календарные отображения
- **Уведомления**: настраиваемые ежедневные напоминания для заполнения дневника
- **Скачивание данных**: выгрузка всего дневника в формате CSV
- **Импорт CSV**: загрузка данных из CSV-файлов для быстрого переноса истории записей
- **Обмен данными**: возможность безопасно делиться своими записями с другими пользователями
- **Безопасность**: шифрование данных на основе Telegram-аутентификации, не требующее ввода дополнительных паролей

## Установка и запуск

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/yourusername/mood-tracker-bot.git
   cd mood-tracker-bot
   ```

2. Создайте виртуальное окружение и установите зависимости:
   ```
   python -m venv venv
   source venv/bin/activate  # На Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```

3. Создайте файл `.env` в корневой директории и добавьте токен вашего бота:
   ```
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
   ```

4. Запустите бот:
   ```
   python main.py
   ```

## Структура проекта

Проект имеет модульную структуру для удобства поддержки и расширения:

```
mood-tracker-bot/
├── main.py                    # Точка входа для запуска бота
└── src/                       # Исходный код проекта
    ├── config.py              # Настройки и конфигурация
    ├── bot.py                 # Основной класс бота
    ├── handlers/              # Обработчики команд и сообщений
    │   ├── basic.py           # Базовые команды (start, help)
    │   ├── entry.py           # Добавление новых записей
    │   ├── stats.py           # Статистика и выгрузка данных
    │   ├── notifications.py   # Уведомления
    │   ├── sharing.py         # Обмен данными
    │   ├── visualization.py   # Визуализация данных
    │   ├── import_csv.py      # Импорт данных из CSV
    │   ├── delete.py          # Удаление записей
    │   └── analytics.py       # Аналитика паттернов и инсайты
    ├── data/                  # Управление данными
    │   ├── storage.py         # Хранение и загрузка данных
    │   ├── encryption.py      # Шифрование и дешифрование
    │   └── models.py          # Структуры данных
    ├── analytics/             # Аналитика и выявление паттернов
    │   └── pattern_detection.py # Алгоритмы выявления паттернов
    ├── utils/                 # Вспомогательные функции
    └── visualization/         # Визуализация данных
```

## Технические характеристики

- Python с библиотекой python-telegram-bot
- Данные хранятся в CSV файлах, индивидуальных для каждого пользователя
- Шифрование с использованием библиотеки cryptography и алгоритма Fernet (AES)
- Автоматическая генерация ключей шифрования на основе Telegram ID пользователя
- Визуализация с использованием matplotlib и pandas
- Аналитика паттернов с использованием методов статистического анализа

## Команды бота

- `/start` - начать работу с ботом
- `/help` - показать помощь по командам (категоризированную)
- `/add` - добавить новую запись (можно использовать многократно в течение дня)
- `/stats` - показать статистику
- `/visualize` - построить графики на основе данных
- `/analytics` - выявить паттерны и получить персонализированные инсайты
- `/download` - скачать дневник в формате CSV
- `/import` - импортировать данные из CSV-файла
- `/delete` - удалить записи (все или за определенную дату)
- `/send` - отправить дневник другому пользователю
- `/view_shared` - просмотреть полученный дневник
- `/id` - узнать свой ID для получения дневников
- `/notify HH:MM` - настроить ежедневные уведомления
- `/cancel_notify` - отменить уведомления
- `/recent` - показать последние записи

## Обновление записей в течение дня

Бот позволяет добавлять новые записи и обновлять существующие в течение дня. Каждый раз, когда вы используете команду `/add` в один и тот же день, бот заменяет предыдущую запись за этот день на новую. Это удобно для:

- Обновления показателей по мере изменения состояния в течение дня
- Исправления ошибок ввода
- Добавления информации к комментариям
- Фиксации вечерних показателей после утреннего ввода

При добавлении новой записи за текущий день бот уведомит вас о том, что предыдущая запись будет заменена.

## Аналитика паттернов

Встроенная аналитика обрабатывает накопленные данные и предоставляет персонализированные инсайты:

- **Корреляции**: выявление связи между различными показателями (например, сон и настроение)
- **Еженедельные паттерны**: определение лучших и худших дней недели
- **Циклы настроения**: обнаружение повторяющихся паттернов в динамике настроения
- **Сравнение будни/выходные**: анализ различий между рабочими днями и выходными
- **Персонализированные рекомендации**: предложения, основанные на выявленных закономерностях

Для получения точных результатов рекомендуется иметь не менее 7 записей.

## Формат CSV для импорта

Для импорта данных используйте CSV-файл со следующими колонками:
- `date` - дата в формате YYYY-MM-DD
- `mood` - настроение (от 1 до 10)
- `sleep` - качество сна (от 1 до 10)
- `balance` - ровность настроения (от 1 до 10)
- `mania` - уровень мании (от 1 до 10)
- `depression` - уровень депрессии (от 1 до 10)
- `anxiety` - уровень тревоги (от 1 до 10)
- `irritability` - раздражительность (от 1 до 10)
- `productivity` - работоспособность (от 1 до 10)
- `sociability` - общительность (от 1 до 10)
- `comment` - комментарий (необязательно)

**Примечание**: При импорте CSV, если в файле есть записи с датами, которые уже существуют в вашем дневнике, новые записи заменят старые. Система поддерживает только одну запись на каждый день.

## Дальнейшее развитие

Планируемые улучшения включают:
- Отслеживание приема медикаментов и их влияние на показатели
- Переход на базы данных SQLite/PostgreSQL для более эффективного хранения
- Расширенные алгоритмы машинного обучения для более точного прогнозирования
- Интерфейс для специалистов (психологов/терапевтов)

## Лицензия

MIT License