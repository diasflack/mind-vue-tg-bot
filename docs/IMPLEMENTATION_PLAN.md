# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –æ–ø—Ä–æ—Å—ã

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è: Test-Driven Development (TDD)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
1. ‚úçÔ∏è **–ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã** (–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–∞–ª—è—Ç—Å—è)
2. ‚ñ∂Ô∏è **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** (—É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å)
3. üíª **–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥** (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
4. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** (—É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—Ä–æ—à–ª–∏)
5. ‚ôªÔ∏è **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

---

## Phase 1: –í–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è - –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 1.1 –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–µ—Å—Ç—ã:**
- `tests/test_impressions_migration.py`
  - `test_impressions_table_created()`
  - `test_impression_tags_table_created()`
  - `test_impression_tag_relations_table_created()`
  - `test_indexes_created()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/migrations/001_add_impressions_tables.py`
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü impressions, impression_tags, impression_tag_relations
  - –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
  - –§—É–Ω–∫—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã –≤ SQLite
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Foreign keys –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞ (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)

---

### 1.2 –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π

**–¢–µ—Å—Ç—ã:**
- `tests/test_impressions_models.py`
  - `test_impression_creation()`
  - `test_impression_validation()`
  - `test_impression_to_dict()`
  - `test_impression_from_dict()`
  - `test_impression_tag_creation()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/models.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `class Impression` - –º–æ–¥–µ–ª—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è
  - `class ImpressionTag` - –º–æ–¥–µ–ª—å —Ç–µ–≥–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å 1-10)
- ‚úÖ TypedDict –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

---

### 1.3 –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π

**–¢–µ—Å—Ç—ã:**
- `tests/test_impressions_storage.py`
  - `test_save_impression()`
  - `test_get_impressions_by_date()`
  - `test_get_impressions_by_date_range()`
  - `test_get_impressions_with_tags()`
  - `test_update_impression()`
  - `test_delete_impression()`
  - `test_create_tag()`
  - `test_get_user_tags()`
  - `test_attach_tag_to_impression()`
  - `test_get_impressions_by_category()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/impressions_storage.py`
  - `save_impression()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞)
  - `get_user_impressions()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
  - `delete_impression()` - —É–¥–∞–ª–µ–Ω–∏–µ
  - `create_tag()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞
  - `get_user_tags()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `attach_tags_to_impression()` - –ø—Ä–∏–≤—è–∑–∫–∞ —Ç–µ–≥–æ–≤
  - `get_impressions_by_category()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏/—Ç–µ–≥–∞–º
- ‚úÖ –¢–µ–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

### 1.4 –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è

**–¢–µ—Å—Ç—ã:**
- `tests/test_impression_handlers.py`
  - `test_start_impression_command()`
  - `test_impression_text_input()`
  - `test_impression_intensity_input()`
  - `test_impression_intensity_skip()`
  - `test_impression_category_selection()`
  - `test_impression_category_skip()`
  - `test_impression_tags_input()`
  - `test_impression_tags_skip()`
  - `test_impression_saved_successfully()`
  - `test_impression_cancel()`
  - `test_impression_link_to_entry()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/impression_handlers.py`
  - `start_impression()` - –Ω–∞—á–∞–ª–æ –¥–∏–∞–ª–æ–≥–∞ /impression
  - `handle_impression_text()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
  - `handle_impression_intensity()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
  - `handle_impression_category()` - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - `handle_impression_tags()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤
  - `finish_impression()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  - `link_to_entry()` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø–∏—Å–∏ –¥–Ω—è
  - ConversationHandler –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–º

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –î–∏–∞–ª–æ–≥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ —ç—Ç–∞–ø—ã
- ‚úÖ –ü—Ä–æ–ø—É—Å–∫ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç (/skip)
- ‚úÖ –û—Ç–º–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (/cancel)
- ‚úÖ –í–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 1.5 –ü—Ä–æ—Å–º–æ—Ç—Ä –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π

**–¢–µ—Å—Ç—ã:**
- `tests/test_impression_viewing.py`
  - `test_view_today_impressions()`
  - `test_view_today_impressions_empty()`
  - `test_view_impressions_history()`
  - `test_view_impressions_by_category()`
  - `test_view_impressions_by_tag()`
  - `test_view_impressions_pagination()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/impression_handlers.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `show_today_impressions()` - /impressions
  - `show_impressions_history()` - /impressions_history —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π
  - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–ª—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–µ
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è >10 –∑–∞–ø–∏—Å–µ–π

---

## Phase 2: –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–æ—Å–æ–≤ - –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —à–∞–±–ª–æ–Ω–æ–≤ –æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

### 2.1 –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_surveys_migration.py`
  - `test_survey_templates_table_created()`
  - `test_survey_questions_table_created()`
  - `test_survey_responses_table_created()`
  - `test_user_survey_preferences_table_created()`
  - `test_cascade_delete_works()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/migrations/002_add_surveys_tables.py`
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü survey_templates, survey_questions, survey_responses, user_survey_preferences
  - –ò–Ω–¥–µ–∫—Å—ã –∏ foreign keys
  - –§—É–Ω–∫—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ CASCADE DELETE —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞

---

### 2.2 –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_surveys_models.py`
  - `test_survey_template_creation()`
  - `test_survey_question_creation()`
  - `test_question_validation_by_type()`
  - `test_survey_response_creation()`
  - `test_config_json_parsing()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/models.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `class SurveyTemplate`
  - `class SurveyQuestion`
  - `class SurveyResponse`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ JSON config –ø–∞—Ä—Å–∏—Ç—Å—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤

---

### 2.3 –°–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_system_surveys.py`
  - `test_cbt_journal_template()`
  - `test_addiction_journal_template()`
  - `test_gratitude_journal_template()`
  - `test_sleep_journal_template()`
  - `test_system_surveys_loaded()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/system_surveys.py`
  - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 4 —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
  - –§—É–Ω–∫—Ü–∏—è `load_system_surveys()` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –í—Å–µ 4 —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–ø—Ä–æ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ë–î –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ù–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ

---

### 2.4 –•—Ä–∞–Ω–∏–ª–∏—â–µ –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_surveys_storage.py`
  - `test_get_all_templates()`
  - `test_get_template_by_id()`
  - `test_get_template_by_name()`
  - `test_get_template_questions()`
  - `test_save_response()`
  - `test_get_user_responses()`
  - `test_get_responses_by_template()`
  - `test_delete_response()`
  - `test_encryption_decryption()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/data/surveys_storage.py`
  - `get_available_templates()` - —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤
  - `get_template_questions()` - –≤–æ–ø—Ä–æ—Å—ã —à–∞–±–ª–æ–Ω–∞
  - `save_survey_response()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ)
  - `get_user_survey_responses()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
  - `delete_survey_response()` - —É–¥–∞–ª–µ–Ω–∏–µ
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –û—Ç–≤–µ—Ç—ã —à–∏—Ñ—Ä—É—é—Ç—Å—è
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —à–∞–±–ª–æ–Ω—É/–¥–∞—Ç–µ

---

### 2.5 –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ä–æ—Å–∞

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_fill_handlers.py`
  - `test_list_surveys_command()`
  - `test_start_fill_survey()`
  - `test_handle_text_question()`
  - `test_handle_numeric_question()`
  - `test_handle_numeric_validation()`
  - `test_handle_choice_question()`
  - `test_handle_yes_no_question()`
  - `test_handle_time_question()`
  - `test_handle_required_skip_rejected()`
  - `test_handle_optional_skip_accepted()`
  - `test_survey_completion()`
  - `test_survey_cancel()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_handlers.py`
  - `list_surveys()` - /surveys - —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–ø—Ä–æ—Å–æ–≤
  - `start_fill_survey()` - /fill <–Ω–∞–∑–≤–∞–Ω–∏–µ> - –Ω–∞—á–∞–ª–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
  - `handle_question_answer()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ —Ç–∏–ø—É
  - `validate_answer()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
  - `show_next_question()` - –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
  - `complete_survey()` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  - ConversationHandler –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –î–∏–∞–ª–æ–≥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ç–∏–ø–∞–º
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ä–µ–∑—é–º–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞

---

### 2.6 –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ–ø—Ä–æ—Å—ã

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_viewing.py`
  - `test_view_my_responses()`
  - `test_view_my_responses_empty()`
  - `test_view_responses_by_survey()`
  - `test_view_single_response()`
  - `test_view_responses_pagination()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_handlers.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `show_my_responses()` - /my_responses - –≤—Å–µ –æ—Ç–≤–µ—Ç—ã
  - `show_response_detail()` - –¥–µ—Ç–∞–ª–∏ –æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –æ—Ç–≤–µ—Ç—ã
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–µ
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–ø—Ä–æ—Å—É
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è

---

## Phase 3: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø—Ä–æ—Å–æ–≤

**–¶–µ–ª—å:** –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –æ–ø—Ä–æ—Å—ã

### 3.1 –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –æ–ø—Ä–æ—Å–∞

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_builder.py`
  - `test_create_survey_start()`
  - `test_survey_name_input()`
  - `test_survey_description_input()`
  - `test_survey_icon_input()`
  - `test_add_question_numeric()`
  - `test_add_question_text()`
  - `test_add_question_choice()`
  - `test_add_question_yes_no()`
  - `test_mark_question_optional()`
  - `test_reorder_questions()`
  - `test_save_custom_survey()`
  - `test_cancel_survey_creation()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_builder.py`
  - `start_create_survey()` - /create_survey
  - `handle_survey_name()` - –≤–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è
  - `handle_survey_description()` - –≤–≤–æ–¥ –æ–ø–∏—Å–∞–Ω–∏—è
  - `handle_add_question()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
  - `handle_question_type()` - –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
  - `handle_question_config()` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–∞
  - `finish_survey_creation()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  - ConversationHandler

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è choice —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –û–ø—Ä–æ—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- ‚úÖ –û–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é

---

### 3.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –æ–ø—Ä–æ—Å–∞–º–∏

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_management.py`
  - `test_list_my_surveys()`
  - `test_edit_survey()`
  - `test_delete_survey()`
  - `test_delete_survey_with_responses()`
  - `test_activate_deactivate_survey()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_builder.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `list_my_surveys()` - —Å–ø–∏—Å–æ–∫ —Å–≤–æ–∏—Ö –æ–ø—Ä–æ—Å–æ–≤
  - `edit_survey()` - /edit_survey <id>
  - `delete_survey()` - /delete_survey <id>
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –æ–ø—Ä–æ—Å—ã
- ‚úÖ –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –æ–ø—Ä–æ—Å
- ‚úÖ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ—Ç–≤–µ—Ç–∞—Ö
- ‚úÖ –ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —á—É–∂–∏–µ –æ–ø—Ä–æ—Å—ã

---

## Phase 4: –ë–∞–∑–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º –∏ –æ–ø—Ä–æ—Å–∞–º

### 4.1 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π

**–¢–µ—Å—Ç—ã:**
- `tests/test_impression_analytics.py`
  - `test_impressions_by_category_stats()`
  - `test_impressions_by_tag_stats()`
  - `test_impressions_intensity_average()`
  - `test_impressions_by_time_of_day()`
  - `test_impressions_by_day_of_week()`
  - `test_impressions_trend()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/impression_analytics.py`
  - `show_impression_analytics()` - /impression_analytics
  - –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º/—Ç–µ–≥–∞–º
  - –°—Ä–µ–¥–Ω—è—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
  - –¢—Ä–µ–Ω–¥—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤

---

### 4.2 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_analytics.py`
  - `test_survey_completion_rate()`
  - `test_numeric_questions_trend()`
  - `test_choice_questions_frequency()`
  - `test_cbt_before_after_comparison()`
  - `test_addiction_craving_trend()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_analytics.py`
  - `show_survey_stats()` - /survey_stats <–Ω–∞–∑–≤–∞–Ω–∏–µ>
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (—Å—Ä–µ–¥–Ω–µ–µ, min, max, —Ç—Ä–µ–Ω–¥)
  - –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–∞ –¥–ª—è choice
  - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –ö–ü–¢ (–¥–æ/–ø–æ—Å–ª–µ)
  - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –¥–Ω–µ–≤–Ω–∏–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª–æ–≤—ã–º –≤–æ–ø—Ä–æ—Å–∞–º
- ‚úÖ –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–æ–≤
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –ö–ü–¢
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≥—Ä–∞—Ñ–∏–∫–∏ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ)

---

## Phase 5: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —ç–∫—Å–ø–æ—Ä—Ç

### 5.1 –ü—Ä–∏–≤—è–∑–∫–∞ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π –∫ –∑–∞–ø–∏—Å—è–º –¥–Ω—è

**–¢–µ—Å—Ç—ã:**
- `tests/test_impression_entry_link.py`
  - `test_link_impression_to_existing_entry()`
  - `test_link_impression_to_new_entry()`
  - `test_show_entry_with_impressions()`
  - `test_unlink_impression()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/impression_handlers.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏ –¥–Ω—è
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π –≤ –∑–∞–ø–∏—Å–∏ –¥–Ω—è

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –í–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –∑–∞–ø–∏—Å–∏
- ‚úÖ –í /recent –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–≤—è–∑–∞—Ç—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ

---

### 5.2 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –æ–ø—Ä–æ—Å–∞–º

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_notifications.py`
  - `test_enable_survey_notification()`
  - `test_disable_survey_notification()`
  - `test_notification_sent_at_time()`
  - `test_notification_not_sent_if_filled_today()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_notifications.py`
  - `manage_survey_notifications()` - /survey_notifications
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –æ–ø—Ä–æ—Å–æ–≤
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä–µ–º—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–ø—Ä–æ—Å–∞
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤–æ–≤—Ä–µ–º—è
- ‚úÖ –ù–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å

---

### 5.3 –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –æ–ø—Ä–æ—Å—ã

**–¢–µ—Å—Ç—ã:**
- `tests/test_favorite_surveys.py`
  - `test_add_to_favorites()`
  - `test_remove_from_favorites()`
  - `test_list_favorites()`
  - `test_quick_fill_favorite()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_handlers.py` (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
  - `manage_favorites()` - /favorite_surveys
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
  - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–∑–±—Ä–∞–Ω–Ω—ã–º

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- ‚úÖ –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ

---

### 5.4 –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

**–¢–µ—Å—Ç—ã:**
- `tests/test_export.py`
  - `test_export_impressions_csv()`
  - `test_export_survey_responses_csv()`
  - `test_export_combined_csv()`
  - `test_export_json()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/export_handlers.py`
  - –≠–∫—Å–ø–æ—Ä—Ç –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π –≤ CSV
  - –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ–ø—Ä–æ—Å—ã –≤ CSV
  - –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
  - JSON —Ñ–æ—Ä–º–∞—Ç

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ CSV –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
- ‚úÖ JSON –≤–∞–ª–∏–¥–Ω—ã–π

---

### 5.5 –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

**–¢–µ—Å—Ç—ã:**
- `tests/test_combined_analytics.py`
  - `test_impressions_mood_correlation()`
  - `test_survey_responses_mood_correlation()`
  - `test_craving_sleep_correlation()`
  - `test_combined_report()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/combined_analytics.py`
  - `/combined_analytics` - –æ–±—â–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
  - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º
  - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ–ø—Ä–æ—Å–æ–≤ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
  - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ –ò–Ω—Å–∞–π—Ç—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–µ

---

## Phase 6: –®–∞—Ä–∏–Ω–≥ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**–¶–µ–ª—å:** –î–µ–ª–∏—Ç—å—Å—è —à–∞–±–ª–æ–Ω–∞–º–∏, –≥—Ä–∞—Ñ–∏–∫–∏

### 6.1 –®–∞—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–æ–≤ –æ–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã:**
- `tests/test_survey_sharing.py`
  - `test_share_survey_template()`
  - `test_import_shared_template()`
  - `test_template_link_generation()`
  - `test_cannot_share_system_survey()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/handlers/survey_sharing.py`
  - `/share_survey <id>` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏
  - –ò–º–ø–æ—Ä—Ç –ø–æ —Å—Å—ã–ª–∫–µ/–∫–æ–¥—É
  - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ú–æ–∂–Ω–æ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—Ä–æ—Å–æ–º
- ‚úÖ –î—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è, —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω

---

### 6.2 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**–¢–µ—Å—Ç—ã:**
- `tests/test_visualization.py`
  - `test_impressions_chart()`
  - `test_survey_trends_chart()`
  - `test_combined_chart()`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `src/visualization/impressions_charts.py`
  - –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π
  - –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –æ–ø—Ä–æ—Å–æ–≤
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ matplotlib

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ß–∏—Ç–∞–µ–º—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ

---

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

1. **Unit —Ç–µ—Å—Ç—ã** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - `tests/unit/`

2. **Integration —Ç–µ—Å—Ç—ã** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - `tests/integration/`

3. **E2E —Ç–µ—Å—Ç—ã** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
   - `tests/e2e/`

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ñ–∞–∑–∞
pytest tests/test_impressions*.py

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=src --cov-report=html

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_impressions_storage.py::test_save_impression -v
```

### Coverage —Ü–µ–ª–∏

- Phase 1: 90%+ coverage –¥–ª—è impressions
- Phase 2: 90%+ coverage –¥–ª—è surveys
- Phase 3-6: 85%+ coverage

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ main.py

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
from src.handlers import impression_handlers, survey_handlers

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Application
app.add_handler(impression_handlers.impression_conv_handler)
app.add_handler(survey_handlers.survey_fill_conv_handler)
# ... –∏ —Ç.–¥.
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ src/data/storage.py

```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
from src.data.migrations import run_all_migrations

def initialize_storage():
    conn = _get_db_connection()
    _migrate_csv_to_sqlite()
    run_all_migrations(conn)  # –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
    logger.info("–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ")
```

---

## Checklist –ø–æ —Ñ–∞–∑–∞–º

### ‚úÖ Phase 1: –í–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è
- [ ] 1.1 –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
- [ ] 1.2 –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- [ ] 1.3 –•—Ä–∞–Ω–∏–ª–∏—â–µ
- [ ] 1.4 –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- [ ] 1.5 –ü—Ä–æ—Å–º–æ—Ç—Ä

### ‚¨ú Phase 2: –û–ø—Ä–æ—Å—ã
- [ ] 2.1 –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
- [ ] 2.2 –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- [ ] 2.3 –°–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
- [ ] 2.4 –•—Ä–∞–Ω–∏–ª–∏—â–µ
- [ ] 2.5 –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–∞
- [ ] 2.6 –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≤–µ—Ç–æ–≤

### ‚¨ú Phase 3: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
- [ ] 3.1 –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
- [ ] 3.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### ‚¨ú Phase 4: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] 4.1 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π
- [ ] 4.2 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–ø—Ä–æ—Å–æ–≤

### ‚¨ú Phase 5: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] 5.1 –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∑–∞–ø–∏—Å—è–º
- [ ] 5.2 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] 5.3 –ò–∑–±—Ä–∞–Ω–Ω—ã–µ
- [ ] 5.4 –≠–∫—Å–ø–æ—Ä—Ç
- [ ] 5.5 –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### ‚¨ú Phase 6: –®–∞—Ä–∏–Ω–≥ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] 6.1 –®–∞—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–æ–≤
- [ ] 6.2 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

---

## –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

- Phase 1: 2-3 –¥–Ω—è
- Phase 2: 3-4 –¥–Ω—è
- Phase 3: 2 –¥–Ω—è
- Phase 4: 2 –¥–Ω—è
- Phase 5: 3 –¥–Ω—è
- Phase 6: 2 –¥–Ω—è

**–ò—Ç–æ–≥–æ:** ~14-18 –¥–Ω–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. –ù–∞—á–∞—Ç—å —Å Phase 1.1 - –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (–æ–Ω–∏ –ø—Ä–æ–≤–∞–ª—è—Ç—Å—è)
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
5. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (–æ–Ω–∏ –ø—Ä–æ–π–¥—É—Ç)
6. –ü–µ—Ä–µ–π—Ç–∏ –∫ Phase 1.2

**–ü—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ Phase 1.1!**
